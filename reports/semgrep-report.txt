                    
                    
┌──────────────────┐
│ 11 Code Findings │
└──────────────────┘
                        
    /src/backend/main.py
    ❯❱ python-path-traversal
          Posible Path Traversal. Validar y sanitizar rutas de archivos antes de usarlas.
                                                                                         
           14┆ if not os.path.exists(DATA_FILE):
            ⋮┆----------------------------------------
           17┆ with open(DATA_FILE, "r") as f:
   
    ❯❱ python-unsafe-json-loads
          Deserialización JSON sin validación previa. Validar el contenido antes de procesar.
                                                                                             
           21┆ data = json.loads(content)
   
    ❯❱ python-path-traversal
          Posible Path Traversal. Validar y sanitizar rutas de archivos antes de usarlas.
                                                                                         
           31┆ with open(DATA_FILE, "w") as f:
   
   ❯❯❱ python-websocket-no-origin-check
          WebSocket acepta conexiones sin validar origen. Implementar verificación de origen.
                                                                                             
           39┆ async def connect(self, websocket: WebSocket, origin: str = None):
           40┆     allowed_origins = os.getenv('ALLOWED_ORIGINS',       
               'http://localhost:4200,http://localhost:3000').split(',')
           41┆     if origin and origin not in allowed_origins:
           42┆         await websocket.close(code=1008, reason="Origin not allowed")
           43┆         return False
           44┆
           45┆     await websocket.accept()
           46┆     self.active_connections.append(websocket)
           47┆     return True
   
    ❯❱ python-websocket-input-validation
          Datos de WebSocket sin validación robusta. Implementar validación de esquema.
                                                                                       
           75┆ origin = websocket.headers.get('origin')
   
    ❯❱ python-unsafe-json-loads
          Deserialización JSON sin validación previa. Validar el contenido antes de procesar.
                                                                                             
           87┆ data = json.loads(raw)
   
    ❯❱ python-websocket-input-validation
          Datos de WebSocket sin validación robusta. Implementar validación de esquema.
                                                                                       
           94┆ if data.get("type") == "click":
            ⋮┆----------------------------------------
           95┆ name = (data.get("name") or "").strip()
                                    
    /src/frontend/nginx/default.conf
    ❯❱ generic.nginx.security.header-redefinition.header-redefinition
          The 'add_header' directive is called in a 'location' block after headers have been set at the server
          block. Calling 'add_header' in the location block will actually overwrite the headers defined in the
          server block, no matter which headers are set. To fix this, explicitly set all headers or set all   
          headers in the server block.                                                                        
          Details: https://sg.run/Lwl7                                                                        
                                                                                                              
           10┆ add_header Cache-Control "no-store";
                                                   
    /src/frontend/src/services/websocket.service.ts
    ❯❱ typescript-websocket-error-handling
          WebSocket creado sin manejo robusto de errores. Implementar onerror y validación.
                                                                                           
           40┆ this.socket = new WebSocket(this.url);
